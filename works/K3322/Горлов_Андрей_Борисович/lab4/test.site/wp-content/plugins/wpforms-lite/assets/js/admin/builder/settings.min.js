"use strict";var WPForms=window.WPForms||{};WPForms.Admin=WPForms.Admin||{},WPForms.Admin.Builder=WPForms.Admin.Builder||{},WPForms.Admin.Builder.Settings=WPForms.Admin.Builder.Settings||function(t,n){var i={},l={},a={init:function(){n(a.ready)},ready:function(){a.setup(),a.initTags(),a.events()},setup:function(){i={$builder:n("#wpforms-builder"),$panel:n("#wpforms-panel-settings"),$selectTags:n("#wpforms-panel-field-settings-form_tags")}},events(){i.$panel.on("keydown","#wpforms-panel-field-settings-form_tags-wrap input",a.addCustomTagInput).on("removeItem","#wpforms-panel-field-settings-form_tags-wrap select",a.editTagsRemoveItem).on("change","#wpforms-panel-field-settings-antispam_v3",a.enableAntispamV3),i.$selectTags.on("change",a.changeTags)},enableAntispamV3(){n("#wpforms-panel-field-settings-antispam").prop("checked",!1).closest(".wpforms-panel-field").toggleClass("wpforms-hidden")},initTags:function(){var e;i.$selectTags.length&&"function"==typeof t.Choices&&(l.tagsChoicesObj=new Choices(i.$selectTags[0],wpforms_builder_settings.choicesjs_config),e=l.tagsChoicesObj.getValue(!0),l.tagsChoicesObj.clearStore().setChoices(wpforms_builder_settings.all_tags_choices,"value","label",!0).setChoiceByValue(e),i.$selectTags.data("choicesjs",l.tagsChoicesObj),a.initTagsHiddenInput())},initTagsHiddenInput:function(){i.$selectTagsHiddenInput=n('<input type="hidden" name="settings[form_tags_json]">'),i.$selectTags.closest(".wpforms-panel-field").append(i.$selectTagsHiddenInput),a.changeTags(null),!0===wpf.initialSave&&(wpf.savedState=wpf.getFormState("#wpforms-builder-form"))},addCustomTagInput:function(e){var t,s;["Enter",","].indexOf(e.key)<0||(e.preventDefault(),e.stopPropagation(),l.tagsChoicesObj&&0!==e.target.value.length&&(t=_.escape(e.target.value).trim(),s=_.map(l.tagsChoicesObj.getValue(),"label").map(function(e){return e.toLowerCase().trim()}),""===t||0<=s.indexOf(t.toLowerCase())?l.tagsChoicesObj.clearInput():(a.addCustomTagInputCreate(t),a.changeTags(e))))},editTagsRemoveItem:function(t){var e,s,a;0<=_.map(wpforms_builder_settings.all_tags_choices,"value").indexOf(t.detail.value)||(s=(e=n(t.target).data("choicesjs")).getValue(!0),a=_.filter(e._currentState.choices,function(e){return e.value!==t.detail.value}),e.clearStore().setChoices(a,"value","label",!0).setChoiceByValue(s))},addCustomTagInputCreate:function(e){var t=_.find(wpforms_builder_settings.all_tags_choices,{label:e});t&&t.value?l.tagsChoicesObj.setChoiceByValue(t.value):l.tagsChoicesObj.setChoices([{value:e,label:e,selected:!0}],"value","label",!1),l.tagsChoicesObj.clearInput()},changeTags:function(e){for(var t=l.tagsChoicesObj.getValue(),s=[],a=0;a<t.length;a++)s.push({value:t[a].value,label:t[a].label});i.$selectTagsHiddenInput.val(JSON.stringify(s))}};return a}((document,window),jQuery),WPForms.Admin.Builder.Settings.init();